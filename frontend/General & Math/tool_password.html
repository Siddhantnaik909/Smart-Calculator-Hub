<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SMART HUB | Ultimate Password Tool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
    <style>
        /* --- Custom Styles for Password Tool --- */
        .mode-tabs { display: flex; gap: 10px; margin-bottom: 25px; background: #f1f5f9; padding: 5px; border-radius: 12px; }
        .mode-btn { flex: 1; padding: 12px; border: none; background: transparent; border-radius: 8px; cursor: pointer; color: var(--text-muted); font-weight: 600; transition: all 0.3s; }
        .mode-btn.active { background-color: var(--bg-card); color: var(--primary-color); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .hidden { display: none; }

        /* Strength Meter */
        .strength-container { margin-top: 15px; background: #f1f5f9; height: 8px; border-radius: 4px; overflow: hidden; position: relative; }
        .strength-bar { height: 100%; width: 0%; transition: width 0.4s ease, background-color 0.4s ease; }
        .strength-text { font-size: 0.85rem; font-weight: 600; margin-top: 5px; text-align: right; }
        
        /* Colors for strength */
        .weak { background-color: #ef4444; color: #ef4444; }
        .medium { background-color: #f59e0b; color: #f59e0b; }
        .strong { background-color: #10b981; color: #10b981; }

        /* Password Display */
        .pass-display {
            font-family: 'Courier New', monospace;
            font-size: 1.4rem;
            letter-spacing: 1px;
            font-weight: 600;
            color: var(--text-header);
            word-break: break-all;
        }

        /* Toast Notification */
        #toast {
            visibility: hidden;
            min-width: 250px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 12px;
            position: fixed;
            z-index: 1000;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            font-size: 0.95rem;
            opacity: 0;
            transition: opacity 0.3s, bottom 0.3s;
        }
        #toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 50px;
        }
    </style>
</head>
<body>

    <div class="dashboard-layout" id="dashboard-wrapper">
        <div class="overlay" id="mobile-overlay"></div>

        <aside class="sidebar">
            <div class="brand-block">
                <i class="fa-solid fa-microchip" style="color: var(--primary-color); margin-right: 12px; font-size: 1.5rem;"></i>
                SMART HUB
            </div>
            <nav class="side-menu">
                <a href="../index.html"><i class="fa fa-home"></i> Dashboard</a>
                <a href="../calculators.html" class="active"><i class="fa-solid fa-calculator"></i> Calculators</a>
                <a href="../history.html"><i class="fa fa-history"></i> History</a>
                <a href="../settings.html"><i class="fa fa-gear"></i> Settings</a>
                <a href="../about.html"><i class="fa fa-circle-info"></i> About</a>
            </nav>
            <div class="sidebar-footer"><p>© 2025 Smart Hub Products.</p></div>
        </aside>

        <main class="main-content">
            <header class="content-header">
                 <div class="mobile-toggle" id="mobile-toggle-btn"><i class="fa fa-bars"></i></div>
                <h1 class="fade-in">Ultimate Password Tool</h1>
            </header>

            <div class="page-body">
                <section class="container grid-section fade-in delay-1">
                    <div class="cat-card stagger-1">
                        
                        <div class="mode-tabs">
                            <button class="mode-btn active" onclick="switchMode('random')" id="btn-random"><i class="fa fa-dice"></i> Random Gen</button>
                            <button class="mode-btn" onclick="switchMode('reference')" id="btn-reference"><i class="fa fa-text-width"></i> Text Transform</button>
                        </div>

                        <div id="mode-random">
                            <div class="sub-cat-list">
                                <div class="sub-link">
                                    <span>Length: <span id="lenDisplay" style="color: var(--primary-color); font-weight: 800;">16</span></span>
                                    <input type="range" id="length" min="6" max="64" value="16" class="form-control" oninput="updateLen(this.value)">
                                </div>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px;">
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="uppercase" checked> Uppercase
                                    </label>
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="lowercase" checked> Lowercase
                                    </label>
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="numbers" checked> Numbers
                                    </label>
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="symbols" checked> Symbols
                                    </label>
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer; grid-column: 1 / -1;">
                                        <input type="checkbox" id="noAmbiguous"> Exclude Ambiguous (l, 1, O, 0)
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div id="mode-reference" class="hidden">
                            <div class="sub-cat-list">
                                <div class="sub-link">
                                    <span>Input Phrase</span>
                                    <input type="text" id="refText" class="form-control" placeholder="e.g. SummerVacation2024">
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="useLeet" checked> Leet Speak (a→@)
                                    </label>
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="capitalize"> Capitalize First
                                    </label>
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="appendNum" checked> Add Random #
                                    </label>
                                    <label class="sub-link" style="justify-content: flex-start; gap: 10px; cursor: pointer;">
                                        <input type="checkbox" id="appendSym" checked> Add Symbol
                                    </label>
                                </div>
                            </div>
                        </div>

                        <button class="sub-link" onclick="generatePassword()" style="background-color: var(--primary-color); color: var(--text-white); justify-content: center; margin-top: 25px; font-size: 1.1rem; padding: 16px;">
                            Generate Secure Password <i class="fa-solid fa-shield-halved" style="margin-left: 10px;"></i>
                        </button>

                    </div>

                    <div id="resultBox" class="cat-card stagger-2" style="display: none;">
                        <h3 style="margin-bottom: 10px;">Your Password</h3>
                        
                        <div class="sub-cat-list">
                            <div class="sub-link" style="background-color: #fff; border: 2px solid #e2e8f0; justify-content: center; padding: 25px; border-radius: 12px; position: relative;">
                                <span id="finalPass" class="pass-display">---</span>
                                
                                <button onclick="copyPassword()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: transparent; border: none; color: var(--primary-color); font-size: 1.2rem; cursor: pointer; padding: 10px;">
                                    <i class="fa-regular fa-copy"></i>
                                </button>
                            </div>
                            
                            <div>
                                <div class="strength-container">
                                    <div id="strengthBar" class="strength-bar"></div>
                                </div>
                                <div id="strengthText" class="strength-text">Strength: --</div>
                            </div>

                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button class="sub-link" onclick="generatePassword()" style="justify-content: center; width: 100%;">
                                    <i class="fa-solid fa-rotate"></i> &nbsp; Regenerate
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                <footer class="content-footer"><p>SMART HUB | All Rights Reserved © 2025</p></footer>
            </div>
        </main>
    </div>

    <div id="toast"><i class="fa-solid fa-check-circle"></i> Password copied to clipboard!</div>
    
    <script src="../script.js"></script>
    <script>
        let currentMode = 'random';

        function switchMode(mode) {
            currentMode = mode;
            document.getElementById('mode-random').classList.toggle('hidden', mode !== 'random');
            document.getElementById('mode-reference').classList.toggle('hidden', mode !== 'reference');
            document.getElementById('btn-random').classList.toggle('active', mode === 'random');
            document.getElementById('btn-reference').classList.toggle('active', mode === 'reference');
            document.getElementById('resultBox').style.display = 'none';
        }

        function updateLen(val) {
            document.getElementById('lenDisplay').innerText = val;
        }

        /* --- LOGIC --- */
        const charSets = {
            upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
            lower: 'abcdefghijklmnopqrstuvwxyz',
            number: '0123456789',
            symbol: '!@#$%^&*()_+~`|}{[]:;?><,./-=',
            ambiguous: 'l1I0O' 
        };

        const leetMap = {
            'a': '@', 'A': '4', 'e': '3', 'E': '3', 
            'i': '!', 'I': '1', 'o': '0', 'O': '0', 
            's': '$', 'S': '5', 't': '7', 'T': '7'
        };

        function generatePassword() {
            let password = '';
            let saveDesc = ''; // For history
            
            if (currentMode === 'random') {
                const length = document.getElementById('length').value;
                const excludeAmbig = document.getElementById('noAmbiguous').checked;
                
                let allowed = '';
                if(document.getElementById('uppercase').checked) allowed += charSets.upper;
                if(document.getElementById('lowercase').checked) allowed += charSets.lower;
                if(document.getElementById('numbers').checked) allowed += charSets.number;
                if(document.getElementById('symbols').checked) allowed += charSets.symbol;

                if (excludeAmbig) {
                    allowed = allowed.replace(/[l1I0O]/g, '');
                }

                if(allowed === '') { showToast("Select at least one character type!"); return; }

                for(let i = 0; i < length; i++) {
                    password += allowed.charAt(Math.floor(Math.random() * allowed.length));
                }
                saveDesc = `Random (Len: ${length})`;

            } else {
                // Reference Mode
                let text = document.getElementById('refText').value.trim();
                if(!text) { showToast("Please enter text first."); return; }

                if(document.getElementById('capitalize').checked) {
                    text = text.charAt(0).toUpperCase() + text.slice(1);
                }

                if(document.getElementById('useLeet').checked) {
                    text = text.split('').map(c => leetMap[c] || c).join('');
                }

                password = text;

                if(document.getElementById('appendNum').checked) {
                    password += Math.floor(Math.random() * 100);
                }

                if(document.getElementById('appendSym').checked) {
                    const syms = '!@#$%^&*';
                    password += syms.charAt(Math.floor(Math.random() * syms.length));
                }
                saveDesc = `Transform (Base: ${document.getElementById('refText').value})`;
            }

            document.getElementById('finalPass').innerText = password;
            document.getElementById('resultBox').style.display = 'block';
            
            const strength = evaluateStrength(password);

            // Save to History (WITHOUT saving actual password for security)
            saveCalculation('Password Tool', saveDesc, `Status: Generated (Strength: ${strength})`);
        }

        /* --- STRENGTH METER --- */
        function evaluateStrength(pw) {
            let score = 0;
            if (pw.length >= 8) score++;
            if (pw.length >= 12) score++;
            if (/[A-Z]/.test(pw)) score++;
            if (/[0-9]/.test(pw)) score++;
            if (/[^A-Za-z0-9]/.test(pw)) score++;

            const bar = document.getElementById('strengthBar');
            const text = document.getElementById('strengthText');
            
            text.className = 'strength-text';
            let strengthLabel = "";

            if (score <= 2) {
                bar.style.width = '30%';
                bar.style.backgroundColor = '#ef4444';
                text.innerText = 'Strength: Weak';
                text.classList.add('weak');
                strengthLabel = "Weak";
            } else if (score <= 4) {
                bar.style.width = '65%';
                bar.style.backgroundColor = '#f59e0b';
                text.innerText = 'Strength: Medium';
                text.classList.add('medium');
                strengthLabel = "Medium";
            } else {
                bar.style.width = '100%';
                bar.style.backgroundColor = '#10b981';
                text.innerText = 'Strength: Strong';
                text.classList.add('strong');
                strengthLabel = "Strong";
            }
            return strengthLabel;
        }

        /* --- CLIPBOARD TOAST --- */
        function copyPassword() {
            const pass = document.getElementById('finalPass').innerText;
            if(pass === '---') return;

            navigator.clipboard.writeText(pass).then(() => {
                showToast("Password copied to clipboard!");
            });
        }

        function showToast(msg) {
            const toast = document.getElementById("toast");
            toast.innerHTML = `<i class="fa-solid fa-info-circle"></i> ${msg}`;
            toast.className = "show";
            setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 3000);
        }
    </script>
</body>
</html>